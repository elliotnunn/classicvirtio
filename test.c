#include <stdarg.h>
#include <stdbool.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <Devices.h>
#include <Files.h>

bool result(bool ok, const char *fmt, ...);
void bailout(const char *fmt, ...);
short mkfile(int size);
const char *modename(char mode);
static const char *errname(short err);

int counter;

void testSetFPos(void) {
	puts("# Testing SetFPos");
	puts("# (Note: System 7 HFS permits seeking to negative file offsets!)");

	struct line {
		int size, initialpos, mode, delta, finalpos, err;
	};

	struct line lines[] = {
		{.size=0, .initialpos=0, .mode=fsAtMark, .delta=0, .finalpos=0, .err=noErr},
		{.size=1, .initialpos=0, .mode=fsAtMark, .delta=0, .finalpos=0, .err=noErr},
		{.size=1, .initialpos=1, .mode=fsAtMark, .delta=0, .finalpos=1, .err=noErr},
		{.size=2, .initialpos=0, .mode=fsAtMark, .delta=0, .finalpos=0, .err=noErr},
		{.size=2, .initialpos=1, .mode=fsAtMark, .delta=0, .finalpos=1, .err=noErr},
		{.size=2, .initialpos=2, .mode=fsAtMark, .delta=0, .finalpos=2, .err=noErr},
		{.size=3, .initialpos=0, .mode=fsAtMark, .delta=0, .finalpos=0, .err=noErr},
		{.size=3, .initialpos=1, .mode=fsAtMark, .delta=0, .finalpos=1, .err=noErr},
		{.size=3, .initialpos=2, .mode=fsAtMark, .delta=0, .finalpos=2, .err=noErr},
		{.size=3, .initialpos=3, .mode=fsAtMark, .delta=0, .finalpos=3, .err=noErr},
		{.size=4, .initialpos=0, .mode=fsAtMark, .delta=0, .finalpos=0, .err=noErr},
		{.size=4, .initialpos=1, .mode=fsAtMark, .delta=0, .finalpos=1, .err=noErr},
		{.size=4, .initialpos=2, .mode=fsAtMark, .delta=0, .finalpos=2, .err=noErr},
		{.size=4, .initialpos=3, .mode=fsAtMark, .delta=0, .finalpos=3, .err=noErr},
		{.size=4, .initialpos=4, .mode=fsAtMark, .delta=0, .finalpos=4, .err=noErr},
		{.size=0, .initialpos=0, .mode=fsFromStart, .delta=-5, .finalpos=0, .err=posErr},
		{.size=0, .initialpos=0, .mode=fsFromStart, .delta=-4, .finalpos=0, .err=posErr},
		{.size=0, .initialpos=0, .mode=fsFromStart, .delta=-3, .finalpos=0, .err=posErr},
		{.size=0, .initialpos=0, .mode=fsFromStart, .delta=-2, .finalpos=0, .err=posErr},
		{.size=0, .initialpos=0, .mode=fsFromStart, .delta=-1, .finalpos=0, .err=posErr},
		{.size=0, .initialpos=0, .mode=fsFromStart, .delta=0, .finalpos=0, .err=noErr},
		{.size=0, .initialpos=0, .mode=fsFromStart, .delta=1, .finalpos=0, .err=eofErr},
		{.size=0, .initialpos=0, .mode=fsFromStart, .delta=2, .finalpos=0, .err=eofErr},
		{.size=0, .initialpos=0, .mode=fsFromStart, .delta=3, .finalpos=0, .err=eofErr},
		{.size=0, .initialpos=0, .mode=fsFromStart, .delta=4, .finalpos=0, .err=eofErr},
		{.size=0, .initialpos=0, .mode=fsFromStart, .delta=5, .finalpos=0, .err=eofErr},
		{.size=1, .initialpos=0, .mode=fsFromStart, .delta=-5, .finalpos=0, .err=posErr},
		{.size=1, .initialpos=0, .mode=fsFromStart, .delta=-4, .finalpos=0, .err=posErr},
		{.size=1, .initialpos=0, .mode=fsFromStart, .delta=-3, .finalpos=0, .err=posErr},
		{.size=1, .initialpos=0, .mode=fsFromStart, .delta=-2, .finalpos=0, .err=posErr},
		{.size=1, .initialpos=0, .mode=fsFromStart, .delta=-1, .finalpos=0, .err=posErr},
		{.size=1, .initialpos=0, .mode=fsFromStart, .delta=0, .finalpos=0, .err=noErr},
		{.size=1, .initialpos=0, .mode=fsFromStart, .delta=1, .finalpos=1, .err=noErr},
		{.size=1, .initialpos=0, .mode=fsFromStart, .delta=2, .finalpos=1, .err=eofErr},
		{.size=1, .initialpos=0, .mode=fsFromStart, .delta=3, .finalpos=1, .err=eofErr},
		{.size=1, .initialpos=0, .mode=fsFromStart, .delta=4, .finalpos=1, .err=eofErr},
		{.size=1, .initialpos=0, .mode=fsFromStart, .delta=5, .finalpos=1, .err=eofErr},
		{.size=2, .initialpos=0, .mode=fsFromStart, .delta=-5, .finalpos=0, .err=posErr},
		{.size=2, .initialpos=0, .mode=fsFromStart, .delta=-4, .finalpos=0, .err=posErr},
		{.size=2, .initialpos=0, .mode=fsFromStart, .delta=-3, .finalpos=0, .err=posErr},
		{.size=2, .initialpos=0, .mode=fsFromStart, .delta=-2, .finalpos=0, .err=posErr},
		{.size=2, .initialpos=0, .mode=fsFromStart, .delta=-1, .finalpos=0, .err=posErr},
		{.size=2, .initialpos=0, .mode=fsFromStart, .delta=0, .finalpos=0, .err=noErr},
		{.size=2, .initialpos=0, .mode=fsFromStart, .delta=1, .finalpos=1, .err=noErr},
		{.size=2, .initialpos=0, .mode=fsFromStart, .delta=2, .finalpos=2, .err=noErr},
		{.size=2, .initialpos=0, .mode=fsFromStart, .delta=3, .finalpos=2, .err=eofErr},
		{.size=2, .initialpos=0, .mode=fsFromStart, .delta=4, .finalpos=2, .err=eofErr},
		{.size=2, .initialpos=0, .mode=fsFromStart, .delta=5, .finalpos=2, .err=eofErr},
		{.size=3, .initialpos=0, .mode=fsFromStart, .delta=-5, .finalpos=0, .err=posErr},
		{.size=3, .initialpos=0, .mode=fsFromStart, .delta=-4, .finalpos=0, .err=posErr},
		{.size=3, .initialpos=0, .mode=fsFromStart, .delta=-3, .finalpos=0, .err=posErr},
		{.size=3, .initialpos=0, .mode=fsFromStart, .delta=-2, .finalpos=0, .err=posErr},
		{.size=3, .initialpos=0, .mode=fsFromStart, .delta=-1, .finalpos=0, .err=posErr},
		{.size=3, .initialpos=0, .mode=fsFromStart, .delta=0, .finalpos=0, .err=noErr},
		{.size=3, .initialpos=0, .mode=fsFromStart, .delta=1, .finalpos=1, .err=noErr},
		{.size=3, .initialpos=0, .mode=fsFromStart, .delta=2, .finalpos=2, .err=noErr},
		{.size=3, .initialpos=0, .mode=fsFromStart, .delta=3, .finalpos=3, .err=noErr},
		{.size=3, .initialpos=0, .mode=fsFromStart, .delta=4, .finalpos=3, .err=eofErr},
		{.size=3, .initialpos=0, .mode=fsFromStart, .delta=5, .finalpos=3, .err=eofErr},
		{.size=4, .initialpos=0, .mode=fsFromStart, .delta=-5, .finalpos=0, .err=posErr},
		{.size=4, .initialpos=0, .mode=fsFromStart, .delta=-4, .finalpos=0, .err=posErr},
		{.size=4, .initialpos=0, .mode=fsFromStart, .delta=-3, .finalpos=0, .err=posErr},
		{.size=4, .initialpos=0, .mode=fsFromStart, .delta=-2, .finalpos=0, .err=posErr},
		{.size=4, .initialpos=0, .mode=fsFromStart, .delta=-1, .finalpos=0, .err=posErr},
		{.size=4, .initialpos=0, .mode=fsFromStart, .delta=0, .finalpos=0, .err=noErr},
		{.size=4, .initialpos=0, .mode=fsFromStart, .delta=1, .finalpos=1, .err=noErr},
		{.size=4, .initialpos=0, .mode=fsFromStart, .delta=2, .finalpos=2, .err=noErr},
		{.size=4, .initialpos=0, .mode=fsFromStart, .delta=3, .finalpos=3, .err=noErr},
		{.size=4, .initialpos=0, .mode=fsFromStart, .delta=4, .finalpos=4, .err=noErr},
		{.size=4, .initialpos=0, .mode=fsFromStart, .delta=5, .finalpos=4, .err=eofErr},
		{.size=0, .initialpos=0, .mode=fsFromLEOF, .delta=-5, .finalpos=0, .err=posErr},
		{.size=0, .initialpos=0, .mode=fsFromLEOF, .delta=-4, .finalpos=0, .err=posErr},
		{.size=0, .initialpos=0, .mode=fsFromLEOF, .delta=-3, .finalpos=0, .err=posErr},
		{.size=0, .initialpos=0, .mode=fsFromLEOF, .delta=-2, .finalpos=0, .err=posErr},
		{.size=0, .initialpos=0, .mode=fsFromLEOF, .delta=-1, .finalpos=0, .err=posErr},
		{.size=0, .initialpos=0, .mode=fsFromLEOF, .delta=0, .finalpos=0, .err=noErr},
		{.size=0, .initialpos=0, .mode=fsFromLEOF, .delta=1, .finalpos=0, .err=eofErr},
		{.size=0, .initialpos=0, .mode=fsFromLEOF, .delta=2, .finalpos=0, .err=eofErr},
		{.size=0, .initialpos=0, .mode=fsFromLEOF, .delta=3, .finalpos=0, .err=eofErr},
		{.size=0, .initialpos=0, .mode=fsFromLEOF, .delta=4, .finalpos=0, .err=eofErr},
		{.size=0, .initialpos=0, .mode=fsFromLEOF, .delta=5, .finalpos=0, .err=eofErr},
		{.size=1, .initialpos=0, .mode=fsFromLEOF, .delta=-5, .finalpos=0, .err=posErr},
		{.size=1, .initialpos=0, .mode=fsFromLEOF, .delta=-4, .finalpos=0, .err=posErr},
		{.size=1, .initialpos=0, .mode=fsFromLEOF, .delta=-3, .finalpos=0, .err=posErr},
		{.size=1, .initialpos=0, .mode=fsFromLEOF, .delta=-2, .finalpos=0, .err=posErr},
		{.size=1, .initialpos=0, .mode=fsFromLEOF, .delta=-1, .finalpos=0, .err=noErr},
		{.size=1, .initialpos=0, .mode=fsFromLEOF, .delta=0, .finalpos=1, .err=noErr},
		{.size=1, .initialpos=0, .mode=fsFromLEOF, .delta=1, .finalpos=1, .err=eofErr},
		{.size=1, .initialpos=0, .mode=fsFromLEOF, .delta=2, .finalpos=1, .err=eofErr},
		{.size=1, .initialpos=0, .mode=fsFromLEOF, .delta=3, .finalpos=1, .err=eofErr},
		{.size=1, .initialpos=0, .mode=fsFromLEOF, .delta=4, .finalpos=1, .err=eofErr},
		{.size=1, .initialpos=0, .mode=fsFromLEOF, .delta=5, .finalpos=1, .err=eofErr},
		{.size=2, .initialpos=0, .mode=fsFromLEOF, .delta=-5, .finalpos=0, .err=posErr},
		{.size=2, .initialpos=0, .mode=fsFromLEOF, .delta=-4, .finalpos=0, .err=posErr},
		{.size=2, .initialpos=0, .mode=fsFromLEOF, .delta=-3, .finalpos=0, .err=posErr},
		{.size=2, .initialpos=0, .mode=fsFromLEOF, .delta=-2, .finalpos=0, .err=noErr},
		{.size=2, .initialpos=0, .mode=fsFromLEOF, .delta=-1, .finalpos=1, .err=noErr},
		{.size=2, .initialpos=0, .mode=fsFromLEOF, .delta=0, .finalpos=2, .err=noErr},
		{.size=2, .initialpos=0, .mode=fsFromLEOF, .delta=1, .finalpos=2, .err=eofErr},
		{.size=2, .initialpos=0, .mode=fsFromLEOF, .delta=2, .finalpos=2, .err=eofErr},
		{.size=2, .initialpos=0, .mode=fsFromLEOF, .delta=3, .finalpos=2, .err=eofErr},
		{.size=2, .initialpos=0, .mode=fsFromLEOF, .delta=4, .finalpos=2, .err=eofErr},
		{.size=2, .initialpos=0, .mode=fsFromLEOF, .delta=5, .finalpos=2, .err=eofErr},
		{.size=3, .initialpos=0, .mode=fsFromLEOF, .delta=-5, .finalpos=0, .err=posErr},
		{.size=3, .initialpos=0, .mode=fsFromLEOF, .delta=-4, .finalpos=0, .err=posErr},
		{.size=3, .initialpos=0, .mode=fsFromLEOF, .delta=-3, .finalpos=0, .err=noErr},
		{.size=3, .initialpos=0, .mode=fsFromLEOF, .delta=-2, .finalpos=1, .err=noErr},
		{.size=3, .initialpos=0, .mode=fsFromLEOF, .delta=-1, .finalpos=2, .err=noErr},
		{.size=3, .initialpos=0, .mode=fsFromLEOF, .delta=0, .finalpos=3, .err=noErr},
		{.size=3, .initialpos=0, .mode=fsFromLEOF, .delta=1, .finalpos=3, .err=eofErr},
		{.size=3, .initialpos=0, .mode=fsFromLEOF, .delta=2, .finalpos=3, .err=eofErr},
		{.size=3, .initialpos=0, .mode=fsFromLEOF, .delta=3, .finalpos=3, .err=eofErr},
		{.size=3, .initialpos=0, .mode=fsFromLEOF, .delta=4, .finalpos=3, .err=eofErr},
		{.size=3, .initialpos=0, .mode=fsFromLEOF, .delta=5, .finalpos=3, .err=eofErr},
		{.size=4, .initialpos=0, .mode=fsFromLEOF, .delta=-5, .finalpos=0, .err=posErr},
		{.size=4, .initialpos=0, .mode=fsFromLEOF, .delta=-4, .finalpos=0, .err=noErr},
		{.size=4, .initialpos=0, .mode=fsFromLEOF, .delta=-3, .finalpos=1, .err=noErr},
		{.size=4, .initialpos=0, .mode=fsFromLEOF, .delta=-2, .finalpos=2, .err=noErr},
		{.size=4, .initialpos=0, .mode=fsFromLEOF, .delta=-1, .finalpos=3, .err=noErr},
		{.size=4, .initialpos=0, .mode=fsFromLEOF, .delta=0, .finalpos=4, .err=noErr},
		{.size=4, .initialpos=0, .mode=fsFromLEOF, .delta=1, .finalpos=4, .err=eofErr},
		{.size=4, .initialpos=0, .mode=fsFromLEOF, .delta=2, .finalpos=4, .err=eofErr},
		{.size=4, .initialpos=0, .mode=fsFromLEOF, .delta=3, .finalpos=4, .err=eofErr},
		{.size=4, .initialpos=0, .mode=fsFromLEOF, .delta=4, .finalpos=4, .err=eofErr},
		{.size=4, .initialpos=0, .mode=fsFromLEOF, .delta=5, .finalpos=4, .err=eofErr},
		{.size=0, .initialpos=0, .mode=fsFromMark, .delta=-5, .finalpos=0, .err=posErr},
		{.size=0, .initialpos=0, .mode=fsFromMark, .delta=-4, .finalpos=0, .err=posErr},
		{.size=0, .initialpos=0, .mode=fsFromMark, .delta=-3, .finalpos=0, .err=posErr},
		{.size=0, .initialpos=0, .mode=fsFromMark, .delta=-2, .finalpos=0, .err=posErr},
		{.size=0, .initialpos=0, .mode=fsFromMark, .delta=-1, .finalpos=0, .err=posErr},
		{.size=0, .initialpos=0, .mode=fsFromMark, .delta=0, .finalpos=0, .err=noErr},
		{.size=0, .initialpos=0, .mode=fsFromMark, .delta=1, .finalpos=0, .err=eofErr},
		{.size=0, .initialpos=0, .mode=fsFromMark, .delta=2, .finalpos=0, .err=eofErr},
		{.size=0, .initialpos=0, .mode=fsFromMark, .delta=3, .finalpos=0, .err=eofErr},
		{.size=0, .initialpos=0, .mode=fsFromMark, .delta=4, .finalpos=0, .err=eofErr},
		{.size=0, .initialpos=0, .mode=fsFromMark, .delta=5, .finalpos=0, .err=eofErr},
		{.size=1, .initialpos=0, .mode=fsFromMark, .delta=-5, .finalpos=0, .err=posErr},
		{.size=1, .initialpos=0, .mode=fsFromMark, .delta=-4, .finalpos=0, .err=posErr},
		{.size=1, .initialpos=0, .mode=fsFromMark, .delta=-3, .finalpos=0, .err=posErr},
		{.size=1, .initialpos=0, .mode=fsFromMark, .delta=-2, .finalpos=0, .err=posErr},
		{.size=1, .initialpos=0, .mode=fsFromMark, .delta=-1, .finalpos=0, .err=posErr},
		{.size=1, .initialpos=0, .mode=fsFromMark, .delta=0, .finalpos=0, .err=noErr},
		{.size=1, .initialpos=0, .mode=fsFromMark, .delta=1, .finalpos=1, .err=noErr},
		{.size=1, .initialpos=0, .mode=fsFromMark, .delta=2, .finalpos=1, .err=eofErr},
		{.size=1, .initialpos=0, .mode=fsFromMark, .delta=3, .finalpos=1, .err=eofErr},
		{.size=1, .initialpos=0, .mode=fsFromMark, .delta=4, .finalpos=1, .err=eofErr},
		{.size=1, .initialpos=0, .mode=fsFromMark, .delta=5, .finalpos=1, .err=eofErr},
		{.size=1, .initialpos=1, .mode=fsFromMark, .delta=-5, .finalpos=1, .err=posErr},
		{.size=1, .initialpos=1, .mode=fsFromMark, .delta=-4, .finalpos=1, .err=posErr},
		{.size=1, .initialpos=1, .mode=fsFromMark, .delta=-3, .finalpos=1, .err=posErr},
		{.size=1, .initialpos=1, .mode=fsFromMark, .delta=-2, .finalpos=1, .err=posErr},
		{.size=1, .initialpos=1, .mode=fsFromMark, .delta=-1, .finalpos=0, .err=noErr},
		{.size=1, .initialpos=1, .mode=fsFromMark, .delta=0, .finalpos=1, .err=noErr},
		{.size=1, .initialpos=1, .mode=fsFromMark, .delta=1, .finalpos=1, .err=eofErr},
		{.size=1, .initialpos=1, .mode=fsFromMark, .delta=2, .finalpos=1, .err=eofErr},
		{.size=1, .initialpos=1, .mode=fsFromMark, .delta=3, .finalpos=1, .err=eofErr},
		{.size=1, .initialpos=1, .mode=fsFromMark, .delta=4, .finalpos=1, .err=eofErr},
		{.size=1, .initialpos=1, .mode=fsFromMark, .delta=5, .finalpos=1, .err=eofErr},
		{.size=2, .initialpos=0, .mode=fsFromMark, .delta=-5, .finalpos=0, .err=posErr},
		{.size=2, .initialpos=0, .mode=fsFromMark, .delta=-4, .finalpos=0, .err=posErr},
		{.size=2, .initialpos=0, .mode=fsFromMark, .delta=-3, .finalpos=0, .err=posErr},
		{.size=2, .initialpos=0, .mode=fsFromMark, .delta=-2, .finalpos=0, .err=posErr},
		{.size=2, .initialpos=0, .mode=fsFromMark, .delta=-1, .finalpos=0, .err=posErr},
		{.size=2, .initialpos=0, .mode=fsFromMark, .delta=0, .finalpos=0, .err=noErr},
		{.size=2, .initialpos=0, .mode=fsFromMark, .delta=1, .finalpos=1, .err=noErr},
		{.size=2, .initialpos=0, .mode=fsFromMark, .delta=2, .finalpos=2, .err=noErr},
		{.size=2, .initialpos=0, .mode=fsFromMark, .delta=3, .finalpos=2, .err=eofErr},
		{.size=2, .initialpos=0, .mode=fsFromMark, .delta=4, .finalpos=2, .err=eofErr},
		{.size=2, .initialpos=0, .mode=fsFromMark, .delta=5, .finalpos=2, .err=eofErr},
		{.size=2, .initialpos=1, .mode=fsFromMark, .delta=-5, .finalpos=1, .err=posErr},
		{.size=2, .initialpos=1, .mode=fsFromMark, .delta=-4, .finalpos=1, .err=posErr},
		{.size=2, .initialpos=1, .mode=fsFromMark, .delta=-3, .finalpos=1, .err=posErr},
		{.size=2, .initialpos=1, .mode=fsFromMark, .delta=-2, .finalpos=1, .err=posErr},
		{.size=2, .initialpos=1, .mode=fsFromMark, .delta=-1, .finalpos=0, .err=noErr},
		{.size=2, .initialpos=1, .mode=fsFromMark, .delta=0, .finalpos=1, .err=noErr},
		{.size=2, .initialpos=1, .mode=fsFromMark, .delta=1, .finalpos=2, .err=noErr},
		{.size=2, .initialpos=1, .mode=fsFromMark, .delta=2, .finalpos=2, .err=eofErr},
		{.size=2, .initialpos=1, .mode=fsFromMark, .delta=3, .finalpos=2, .err=eofErr},
		{.size=2, .initialpos=1, .mode=fsFromMark, .delta=4, .finalpos=2, .err=eofErr},
		{.size=2, .initialpos=1, .mode=fsFromMark, .delta=5, .finalpos=2, .err=eofErr},
		{.size=2, .initialpos=2, .mode=fsFromMark, .delta=-5, .finalpos=2, .err=posErr},
		{.size=2, .initialpos=2, .mode=fsFromMark, .delta=-4, .finalpos=2, .err=posErr},
		{.size=2, .initialpos=2, .mode=fsFromMark, .delta=-3, .finalpos=2, .err=posErr},
		{.size=2, .initialpos=2, .mode=fsFromMark, .delta=-2, .finalpos=0, .err=noErr},
		{.size=2, .initialpos=2, .mode=fsFromMark, .delta=-1, .finalpos=1, .err=noErr},
		{.size=2, .initialpos=2, .mode=fsFromMark, .delta=0, .finalpos=2, .err=noErr},
		{.size=2, .initialpos=2, .mode=fsFromMark, .delta=1, .finalpos=2, .err=eofErr},
		{.size=2, .initialpos=2, .mode=fsFromMark, .delta=2, .finalpos=2, .err=eofErr},
		{.size=2, .initialpos=2, .mode=fsFromMark, .delta=3, .finalpos=2, .err=eofErr},
		{.size=2, .initialpos=2, .mode=fsFromMark, .delta=4, .finalpos=2, .err=eofErr},
		{.size=2, .initialpos=2, .mode=fsFromMark, .delta=5, .finalpos=2, .err=eofErr},
		{.size=3, .initialpos=0, .mode=fsFromMark, .delta=-5, .finalpos=0, .err=posErr},
		{.size=3, .initialpos=0, .mode=fsFromMark, .delta=-4, .finalpos=0, .err=posErr},
		{.size=3, .initialpos=0, .mode=fsFromMark, .delta=-3, .finalpos=0, .err=posErr},
		{.size=3, .initialpos=0, .mode=fsFromMark, .delta=-2, .finalpos=0, .err=posErr},
		{.size=3, .initialpos=0, .mode=fsFromMark, .delta=-1, .finalpos=0, .err=posErr},
		{.size=3, .initialpos=0, .mode=fsFromMark, .delta=0, .finalpos=0, .err=noErr},
		{.size=3, .initialpos=0, .mode=fsFromMark, .delta=1, .finalpos=1, .err=noErr},
		{.size=3, .initialpos=0, .mode=fsFromMark, .delta=2, .finalpos=2, .err=noErr},
		{.size=3, .initialpos=0, .mode=fsFromMark, .delta=3, .finalpos=3, .err=noErr},
		{.size=3, .initialpos=0, .mode=fsFromMark, .delta=4, .finalpos=3, .err=eofErr},
		{.size=3, .initialpos=0, .mode=fsFromMark, .delta=5, .finalpos=3, .err=eofErr},
		{.size=3, .initialpos=1, .mode=fsFromMark, .delta=-5, .finalpos=1, .err=posErr},
		{.size=3, .initialpos=1, .mode=fsFromMark, .delta=-4, .finalpos=1, .err=posErr},
		{.size=3, .initialpos=1, .mode=fsFromMark, .delta=-3, .finalpos=1, .err=posErr},
		{.size=3, .initialpos=1, .mode=fsFromMark, .delta=-2, .finalpos=1, .err=posErr},
		{.size=3, .initialpos=1, .mode=fsFromMark, .delta=-1, .finalpos=0, .err=noErr},
		{.size=3, .initialpos=1, .mode=fsFromMark, .delta=0, .finalpos=1, .err=noErr},
		{.size=3, .initialpos=1, .mode=fsFromMark, .delta=1, .finalpos=2, .err=noErr},
		{.size=3, .initialpos=1, .mode=fsFromMark, .delta=2, .finalpos=3, .err=noErr},
		{.size=3, .initialpos=1, .mode=fsFromMark, .delta=3, .finalpos=3, .err=eofErr},
		{.size=3, .initialpos=1, .mode=fsFromMark, .delta=4, .finalpos=3, .err=eofErr},
		{.size=3, .initialpos=1, .mode=fsFromMark, .delta=5, .finalpos=3, .err=eofErr},
		{.size=3, .initialpos=2, .mode=fsFromMark, .delta=-5, .finalpos=2, .err=posErr},
		{.size=3, .initialpos=2, .mode=fsFromMark, .delta=-4, .finalpos=2, .err=posErr},
		{.size=3, .initialpos=2, .mode=fsFromMark, .delta=-3, .finalpos=2, .err=posErr},
		{.size=3, .initialpos=2, .mode=fsFromMark, .delta=-2, .finalpos=0, .err=noErr},
		{.size=3, .initialpos=2, .mode=fsFromMark, .delta=-1, .finalpos=1, .err=noErr},
		{.size=3, .initialpos=2, .mode=fsFromMark, .delta=0, .finalpos=2, .err=noErr},
		{.size=3, .initialpos=2, .mode=fsFromMark, .delta=1, .finalpos=3, .err=noErr},
		{.size=3, .initialpos=2, .mode=fsFromMark, .delta=2, .finalpos=3, .err=eofErr},
		{.size=3, .initialpos=2, .mode=fsFromMark, .delta=3, .finalpos=3, .err=eofErr},
		{.size=3, .initialpos=2, .mode=fsFromMark, .delta=4, .finalpos=3, .err=eofErr},
		{.size=3, .initialpos=2, .mode=fsFromMark, .delta=5, .finalpos=3, .err=eofErr},
		{.size=3, .initialpos=3, .mode=fsFromMark, .delta=-5, .finalpos=3, .err=posErr},
		{.size=3, .initialpos=3, .mode=fsFromMark, .delta=-4, .finalpos=3, .err=posErr},
		{.size=3, .initialpos=3, .mode=fsFromMark, .delta=-3, .finalpos=0, .err=noErr},
		{.size=3, .initialpos=3, .mode=fsFromMark, .delta=-2, .finalpos=1, .err=noErr},
		{.size=3, .initialpos=3, .mode=fsFromMark, .delta=-1, .finalpos=2, .err=noErr},
		{.size=3, .initialpos=3, .mode=fsFromMark, .delta=0, .finalpos=3, .err=noErr},
		{.size=3, .initialpos=3, .mode=fsFromMark, .delta=1, .finalpos=3, .err=eofErr},
		{.size=3, .initialpos=3, .mode=fsFromMark, .delta=2, .finalpos=3, .err=eofErr},
		{.size=3, .initialpos=3, .mode=fsFromMark, .delta=3, .finalpos=3, .err=eofErr},
		{.size=3, .initialpos=3, .mode=fsFromMark, .delta=4, .finalpos=3, .err=eofErr},
		{.size=3, .initialpos=3, .mode=fsFromMark, .delta=5, .finalpos=3, .err=eofErr},
		{.size=4, .initialpos=0, .mode=fsFromMark, .delta=-5, .finalpos=0, .err=posErr},
		{.size=4, .initialpos=0, .mode=fsFromMark, .delta=-4, .finalpos=0, .err=posErr},
		{.size=4, .initialpos=0, .mode=fsFromMark, .delta=-3, .finalpos=0, .err=posErr},
		{.size=4, .initialpos=0, .mode=fsFromMark, .delta=-2, .finalpos=0, .err=posErr},
		{.size=4, .initialpos=0, .mode=fsFromMark, .delta=-1, .finalpos=0, .err=posErr},
		{.size=4, .initialpos=0, .mode=fsFromMark, .delta=0, .finalpos=0, .err=noErr},
		{.size=4, .initialpos=0, .mode=fsFromMark, .delta=1, .finalpos=1, .err=noErr},
		{.size=4, .initialpos=0, .mode=fsFromMark, .delta=2, .finalpos=2, .err=noErr},
		{.size=4, .initialpos=0, .mode=fsFromMark, .delta=3, .finalpos=3, .err=noErr},
		{.size=4, .initialpos=0, .mode=fsFromMark, .delta=4, .finalpos=4, .err=noErr},
		{.size=4, .initialpos=0, .mode=fsFromMark, .delta=5, .finalpos=4, .err=eofErr},
		{.size=4, .initialpos=1, .mode=fsFromMark, .delta=-5, .finalpos=1, .err=posErr},
		{.size=4, .initialpos=1, .mode=fsFromMark, .delta=-4, .finalpos=1, .err=posErr},
		{.size=4, .initialpos=1, .mode=fsFromMark, .delta=-3, .finalpos=1, .err=posErr},
		{.size=4, .initialpos=1, .mode=fsFromMark, .delta=-2, .finalpos=1, .err=posErr},
		{.size=4, .initialpos=1, .mode=fsFromMark, .delta=-1, .finalpos=0, .err=noErr},
		{.size=4, .initialpos=1, .mode=fsFromMark, .delta=0, .finalpos=1, .err=noErr},
		{.size=4, .initialpos=1, .mode=fsFromMark, .delta=1, .finalpos=2, .err=noErr},
		{.size=4, .initialpos=1, .mode=fsFromMark, .delta=2, .finalpos=3, .err=noErr},
		{.size=4, .initialpos=1, .mode=fsFromMark, .delta=3, .finalpos=4, .err=noErr},
		{.size=4, .initialpos=1, .mode=fsFromMark, .delta=4, .finalpos=4, .err=eofErr},
		{.size=4, .initialpos=1, .mode=fsFromMark, .delta=5, .finalpos=4, .err=eofErr},
		{.size=4, .initialpos=2, .mode=fsFromMark, .delta=-5, .finalpos=2, .err=posErr},
		{.size=4, .initialpos=2, .mode=fsFromMark, .delta=-4, .finalpos=2, .err=posErr},
		{.size=4, .initialpos=2, .mode=fsFromMark, .delta=-3, .finalpos=2, .err=posErr},
		{.size=4, .initialpos=2, .mode=fsFromMark, .delta=-2, .finalpos=0, .err=noErr},
		{.size=4, .initialpos=2, .mode=fsFromMark, .delta=-1, .finalpos=1, .err=noErr},
		{.size=4, .initialpos=2, .mode=fsFromMark, .delta=0, .finalpos=2, .err=noErr},
		{.size=4, .initialpos=2, .mode=fsFromMark, .delta=1, .finalpos=3, .err=noErr},
		{.size=4, .initialpos=2, .mode=fsFromMark, .delta=2, .finalpos=4, .err=noErr},
		{.size=4, .initialpos=2, .mode=fsFromMark, .delta=3, .finalpos=4, .err=eofErr},
		{.size=4, .initialpos=2, .mode=fsFromMark, .delta=4, .finalpos=4, .err=eofErr},
		{.size=4, .initialpos=2, .mode=fsFromMark, .delta=5, .finalpos=4, .err=eofErr},
		{.size=4, .initialpos=3, .mode=fsFromMark, .delta=-5, .finalpos=3, .err=posErr},
		{.size=4, .initialpos=3, .mode=fsFromMark, .delta=-4, .finalpos=3, .err=posErr},
		{.size=4, .initialpos=3, .mode=fsFromMark, .delta=-3, .finalpos=0, .err=noErr},
		{.size=4, .initialpos=3, .mode=fsFromMark, .delta=-2, .finalpos=1, .err=noErr},
		{.size=4, .initialpos=3, .mode=fsFromMark, .delta=-1, .finalpos=2, .err=noErr},
		{.size=4, .initialpos=3, .mode=fsFromMark, .delta=0, .finalpos=3, .err=noErr},
		{.size=4, .initialpos=3, .mode=fsFromMark, .delta=1, .finalpos=4, .err=noErr},
		{.size=4, .initialpos=3, .mode=fsFromMark, .delta=2, .finalpos=4, .err=eofErr},
		{.size=4, .initialpos=3, .mode=fsFromMark, .delta=3, .finalpos=4, .err=eofErr},
		{.size=4, .initialpos=3, .mode=fsFromMark, .delta=4, .finalpos=4, .err=eofErr},
		{.size=4, .initialpos=3, .mode=fsFromMark, .delta=5, .finalpos=4, .err=eofErr},
		{.size=4, .initialpos=4, .mode=fsFromMark, .delta=-5, .finalpos=4, .err=posErr},
		{.size=4, .initialpos=4, .mode=fsFromMark, .delta=-4, .finalpos=0, .err=noErr},
		{.size=4, .initialpos=4, .mode=fsFromMark, .delta=-3, .finalpos=1, .err=noErr},
		{.size=4, .initialpos=4, .mode=fsFromMark, .delta=-2, .finalpos=2, .err=noErr},
		{.size=4, .initialpos=4, .mode=fsFromMark, .delta=-1, .finalpos=3, .err=noErr},
		{.size=4, .initialpos=4, .mode=fsFromMark, .delta=0, .finalpos=4, .err=noErr},
		{.size=4, .initialpos=4, .mode=fsFromMark, .delta=1, .finalpos=4, .err=eofErr},
		{.size=4, .initialpos=4, .mode=fsFromMark, .delta=2, .finalpos=4, .err=eofErr},
		{.size=4, .initialpos=4, .mode=fsFromMark, .delta=3, .finalpos=4, .err=eofErr},
		{.size=4, .initialpos=4, .mode=fsFromMark, .delta=4, .finalpos=4, .err=eofErr},
		{.size=4, .initialpos=4, .mode=fsFromMark, .delta=5, .finalpos=4, .err=eofErr},
		{-1}
	};

	for (struct line *l=lines; l->size!=-1; l++) {
		short ref = mkfile(l->size);

		// Pre-set the mark
		struct IOParam setuppb = {.ioRefNum=ref, .ioPosMode=fsFromStart, .ioPosOffset=l->initialpos};
		PBSetFPosSync((void *)&setuppb);
		long thepos = 99;
		GetFPos(ref, &thepos);
		if (thepos != l->initialpos) bailout("Could not pre-set mark, wanted %d got %d", l->initialpos, thepos);

		struct IOParam pb = {.ioRefNum=ref, .ioPosMode=l->mode, .ioPosOffset=l->delta};
		PBSetFPosSync((void *)&pb);

		bool ok = pb.ioPosOffset==l->finalpos && pb.ioResult==l->err;
		result(ok, "SetFPos(size=%d, initialpos=%d, mode=%s, delta=%d) -> (finalpos=%d, err=%s)",
			l->size, l->initialpos, modename(l->mode), l->delta, l->finalpos, errname(l->err));

		if (!ok) {
			printf("# got (finalpos=%d, err=%s)\n", (int)pb.ioPosOffset, errname(pb.ioResult));
		}

		thepos = 99;
		GetFPos(ref, &thepos);
		if (thepos != pb.ioPosOffset) bailout("FCB.fcbCrPs != PB.ioPosOffset");

		FSClose(ref);
		FSDelete("\pscratch", 0);
	}
}

void testRead(void) {
	puts("# Testing Read");

	struct line {
		int filesize, initialpos, mode, delta, readsize, err;
		char data[6];
	};

	struct line lines[] = {
		{.filesize=0, .initialpos=0, .mode=fsAtMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=0, .initialpos=0, .mode=fsAtMark, .delta=0, .readsize=1, .data="", .err=eofErr},
		{.filesize=1, .initialpos=0, .mode=fsAtMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsAtMark, .delta=0, .readsize=1, .data="a", .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsAtMark, .delta=0, .readsize=2, .data="a", .err=eofErr},
		{.filesize=1, .initialpos=1, .mode=fsAtMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=1, .initialpos=1, .mode=fsAtMark, .delta=0, .readsize=1, .data="", .err=eofErr},
		{.filesize=2, .initialpos=0, .mode=fsAtMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsAtMark, .delta=0, .readsize=1, .data="a", .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsAtMark, .delta=0, .readsize=2, .data="ab", .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsAtMark, .delta=0, .readsize=3, .data="ab", .err=eofErr},
		{.filesize=2, .initialpos=1, .mode=fsAtMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsAtMark, .delta=0, .readsize=1, .data="b", .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsAtMark, .delta=0, .readsize=2, .data="b", .err=eofErr},
		{.filesize=2, .initialpos=2, .mode=fsAtMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsAtMark, .delta=0, .readsize=1, .data="", .err=eofErr},
		{.filesize=3, .initialpos=0, .mode=fsAtMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsAtMark, .delta=0, .readsize=1, .data="a", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsAtMark, .delta=0, .readsize=2, .data="ab", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsAtMark, .delta=0, .readsize=3, .data="abc", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsAtMark, .delta=0, .readsize=4, .data="abc", .err=eofErr},
		{.filesize=3, .initialpos=1, .mode=fsAtMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsAtMark, .delta=0, .readsize=1, .data="b", .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsAtMark, .delta=0, .readsize=2, .data="bc", .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsAtMark, .delta=0, .readsize=3, .data="bc", .err=eofErr},
		{.filesize=3, .initialpos=2, .mode=fsAtMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsAtMark, .delta=0, .readsize=1, .data="c", .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsAtMark, .delta=0, .readsize=2, .data="c", .err=eofErr},
		{.filesize=3, .initialpos=3, .mode=fsAtMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsAtMark, .delta=0, .readsize=1, .data="", .err=eofErr},
		{.filesize=4, .initialpos=0, .mode=fsAtMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsAtMark, .delta=0, .readsize=1, .data="a", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsAtMark, .delta=0, .readsize=2, .data="ab", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsAtMark, .delta=0, .readsize=3, .data="abc", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsAtMark, .delta=0, .readsize=4, .data="abcd", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsAtMark, .delta=0, .readsize=5, .data="abcd", .err=eofErr},
		{.filesize=4, .initialpos=1, .mode=fsAtMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsAtMark, .delta=0, .readsize=1, .data="b", .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsAtMark, .delta=0, .readsize=2, .data="bc", .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsAtMark, .delta=0, .readsize=3, .data="bcd", .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsAtMark, .delta=0, .readsize=4, .data="bcd", .err=eofErr},
		{.filesize=4, .initialpos=2, .mode=fsAtMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsAtMark, .delta=0, .readsize=1, .data="c", .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsAtMark, .delta=0, .readsize=2, .data="cd", .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsAtMark, .delta=0, .readsize=3, .data="cd", .err=eofErr},
		{.filesize=4, .initialpos=3, .mode=fsAtMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsAtMark, .delta=0, .readsize=1, .data="d", .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsAtMark, .delta=0, .readsize=2, .data="d", .err=eofErr},
		{.filesize=4, .initialpos=4, .mode=fsAtMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsAtMark, .delta=0, .readsize=1, .data="", .err=eofErr},
		{.filesize=0, .initialpos=0, .mode=fsFromStart, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromStart, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromStart, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromStart, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromStart, .delta=-3, .readsize=0, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromStart, .delta=-3, .readsize=1, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromStart, .delta=-2, .readsize=0, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromStart, .delta=-2, .readsize=1, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromStart, .delta=-1, .readsize=0, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromStart, .delta=-1, .readsize=1, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromStart, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=0, .initialpos=0, .mode=fsFromStart, .delta=0, .readsize=1, .data="", .err=eofErr},
		{.filesize=0, .initialpos=0, .mode=fsFromStart, .delta=1, .readsize=0, .data="", .err=eofErr},
		{.filesize=1, .initialpos=0, .mode=fsFromStart, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromStart, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromStart, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromStart, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromStart, .delta=-3, .readsize=0, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromStart, .delta=-3, .readsize=1, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromStart, .delta=-2, .readsize=0, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromStart, .delta=-2, .readsize=1, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromStart, .delta=-1, .readsize=0, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromStart, .delta=-1, .readsize=1, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromStart, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsFromStart, .delta=0, .readsize=1, .data="a", .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsFromStart, .delta=0, .readsize=2, .data="a", .err=eofErr},
		{.filesize=1, .initialpos=0, .mode=fsFromStart, .delta=1, .readsize=0, .data="", .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsFromStart, .delta=1, .readsize=1, .data="", .err=eofErr},
		{.filesize=1, .initialpos=0, .mode=fsFromStart, .delta=2, .readsize=0, .data="", .err=eofErr},
		{.filesize=2, .initialpos=0, .mode=fsFromStart, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromStart, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromStart, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromStart, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromStart, .delta=-3, .readsize=0, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromStart, .delta=-3, .readsize=1, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromStart, .delta=-2, .readsize=0, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromStart, .delta=-2, .readsize=1, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromStart, .delta=-1, .readsize=0, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromStart, .delta=-1, .readsize=1, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromStart, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromStart, .delta=0, .readsize=1, .data="a", .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromStart, .delta=0, .readsize=2, .data="ab", .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromStart, .delta=0, .readsize=3, .data="ab", .err=eofErr},
		{.filesize=2, .initialpos=0, .mode=fsFromStart, .delta=1, .readsize=0, .data="", .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromStart, .delta=1, .readsize=1, .data="b", .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromStart, .delta=1, .readsize=2, .data="b", .err=eofErr},
		{.filesize=2, .initialpos=0, .mode=fsFromStart, .delta=2, .readsize=0, .data="", .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromStart, .delta=2, .readsize=1, .data="", .err=eofErr},
		{.filesize=2, .initialpos=0, .mode=fsFromStart, .delta=3, .readsize=0, .data="", .err=eofErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=-3, .readsize=0, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=-3, .readsize=1, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=-2, .readsize=0, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=-2, .readsize=1, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=-1, .readsize=0, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=-1, .readsize=1, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=0, .readsize=1, .data="a", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=0, .readsize=2, .data="ab", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=0, .readsize=3, .data="abc", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=0, .readsize=4, .data="abc", .err=eofErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=1, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=1, .readsize=1, .data="b", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=1, .readsize=2, .data="bc", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=1, .readsize=3, .data="bc", .err=eofErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=2, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=2, .readsize=1, .data="c", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=2, .readsize=2, .data="c", .err=eofErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=3, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=3, .readsize=1, .data="", .err=eofErr},
		{.filesize=3, .initialpos=0, .mode=fsFromStart, .delta=4, .readsize=0, .data="", .err=eofErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=-3, .readsize=0, .data="", .err=posErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=-3, .readsize=1, .data="", .err=posErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=-2, .readsize=0, .data="", .err=posErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=-2, .readsize=1, .data="", .err=posErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=-1, .readsize=0, .data="", .err=posErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=-1, .readsize=1, .data="", .err=posErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=0, .readsize=1, .data="a", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=0, .readsize=2, .data="ab", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=0, .readsize=3, .data="abc", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=0, .readsize=4, .data="abcd", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=0, .readsize=5, .data="abcd", .err=eofErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=1, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=1, .readsize=1, .data="b", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=1, .readsize=2, .data="bc", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=1, .readsize=3, .data="bcd", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=1, .readsize=4, .data="bcd", .err=eofErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=2, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=2, .readsize=1, .data="c", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=2, .readsize=2, .data="cd", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=2, .readsize=3, .data="cd", .err=eofErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=3, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=3, .readsize=1, .data="d", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=3, .readsize=2, .data="d", .err=eofErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=4, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=4, .readsize=1, .data="", .err=eofErr},
		{.filesize=4, .initialpos=0, .mode=fsFromStart, .delta=5, .readsize=0, .data="", .err=eofErr},
		{.filesize=0, .initialpos=0, .mode=fsFromLEOF, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromLEOF, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromLEOF, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromLEOF, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromLEOF, .delta=-3, .readsize=0, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromLEOF, .delta=-3, .readsize=1, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromLEOF, .delta=-2, .readsize=0, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromLEOF, .delta=-2, .readsize=1, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromLEOF, .delta=-1, .readsize=0, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromLEOF, .delta=-1, .readsize=1, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromLEOF, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=0, .initialpos=0, .mode=fsFromLEOF, .delta=0, .readsize=1, .data="", .err=eofErr},
		{.filesize=0, .initialpos=0, .mode=fsFromLEOF, .delta=1, .readsize=0, .data="", .err=eofErr},
		{.filesize=1, .initialpos=0, .mode=fsFromLEOF, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromLEOF, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromLEOF, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromLEOF, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromLEOF, .delta=-3, .readsize=0, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromLEOF, .delta=-3, .readsize=1, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromLEOF, .delta=-2, .readsize=0, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromLEOF, .delta=-2, .readsize=1, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromLEOF, .delta=-1, .readsize=0, .data="", .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsFromLEOF, .delta=-1, .readsize=1, .data="a", .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsFromLEOF, .delta=-1, .readsize=2, .data="a", .err=eofErr},
		{.filesize=1, .initialpos=0, .mode=fsFromLEOF, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsFromLEOF, .delta=0, .readsize=1, .data="", .err=eofErr},
		{.filesize=1, .initialpos=0, .mode=fsFromLEOF, .delta=1, .readsize=0, .data="", .err=eofErr},
		{.filesize=2, .initialpos=0, .mode=fsFromLEOF, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromLEOF, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromLEOF, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromLEOF, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromLEOF, .delta=-3, .readsize=0, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromLEOF, .delta=-3, .readsize=1, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromLEOF, .delta=-2, .readsize=0, .data="", .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromLEOF, .delta=-2, .readsize=1, .data="a", .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromLEOF, .delta=-2, .readsize=2, .data="ab", .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromLEOF, .delta=-2, .readsize=3, .data="ab", .err=eofErr},
		{.filesize=2, .initialpos=0, .mode=fsFromLEOF, .delta=-1, .readsize=0, .data="", .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromLEOF, .delta=-1, .readsize=1, .data="b", .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromLEOF, .delta=-1, .readsize=2, .data="b", .err=eofErr},
		{.filesize=2, .initialpos=0, .mode=fsFromLEOF, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromLEOF, .delta=0, .readsize=1, .data="", .err=eofErr},
		{.filesize=2, .initialpos=0, .mode=fsFromLEOF, .delta=1, .readsize=0, .data="", .err=eofErr},
		{.filesize=3, .initialpos=0, .mode=fsFromLEOF, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromLEOF, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromLEOF, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromLEOF, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromLEOF, .delta=-3, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromLEOF, .delta=-3, .readsize=1, .data="a", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromLEOF, .delta=-3, .readsize=2, .data="ab", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromLEOF, .delta=-3, .readsize=3, .data="abc", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromLEOF, .delta=-3, .readsize=4, .data="abc", .err=eofErr},
		{.filesize=3, .initialpos=0, .mode=fsFromLEOF, .delta=-2, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromLEOF, .delta=-2, .readsize=1, .data="b", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromLEOF, .delta=-2, .readsize=2, .data="bc", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromLEOF, .delta=-2, .readsize=3, .data="bc", .err=eofErr},
		{.filesize=3, .initialpos=0, .mode=fsFromLEOF, .delta=-1, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromLEOF, .delta=-1, .readsize=1, .data="c", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromLEOF, .delta=-1, .readsize=2, .data="c", .err=eofErr},
		{.filesize=3, .initialpos=0, .mode=fsFromLEOF, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromLEOF, .delta=0, .readsize=1, .data="", .err=eofErr},
		{.filesize=3, .initialpos=0, .mode=fsFromLEOF, .delta=1, .readsize=0, .data="", .err=eofErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=-4, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=-4, .readsize=1, .data="a", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=-4, .readsize=2, .data="ab", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=-4, .readsize=3, .data="abc", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=-4, .readsize=4, .data="abcd", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=-4, .readsize=5, .data="abcd", .err=eofErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=-3, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=-3, .readsize=1, .data="b", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=-3, .readsize=2, .data="bc", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=-3, .readsize=3, .data="bcd", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=-3, .readsize=4, .data="bcd", .err=eofErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=-2, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=-2, .readsize=1, .data="c", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=-2, .readsize=2, .data="cd", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=-2, .readsize=3, .data="cd", .err=eofErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=-1, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=-1, .readsize=1, .data="d", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=-1, .readsize=2, .data="d", .err=eofErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=0, .readsize=1, .data="", .err=eofErr},
		{.filesize=4, .initialpos=0, .mode=fsFromLEOF, .delta=1, .readsize=0, .data="", .err=eofErr},
		{.filesize=0, .initialpos=0, .mode=fsFromMark, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromMark, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromMark, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromMark, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromMark, .delta=-3, .readsize=0, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromMark, .delta=-3, .readsize=1, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromMark, .delta=-2, .readsize=0, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromMark, .delta=-2, .readsize=1, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromMark, .delta=-1, .readsize=0, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromMark, .delta=-1, .readsize=1, .data="", .err=posErr},
		{.filesize=0, .initialpos=0, .mode=fsFromMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=0, .initialpos=0, .mode=fsFromMark, .delta=0, .readsize=1, .data="", .err=eofErr},
		{.filesize=0, .initialpos=0, .mode=fsFromMark, .delta=1, .readsize=0, .data="", .err=eofErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=-3, .readsize=0, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=-3, .readsize=1, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=-2, .readsize=0, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=-2, .readsize=1, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=-1, .readsize=0, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=-1, .readsize=1, .data="", .err=posErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=0, .readsize=1, .data="a", .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=0, .readsize=2, .data="a", .err=eofErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=1, .readsize=0, .data="", .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=1, .readsize=1, .data="", .err=eofErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=2, .readsize=0, .data="", .err=eofErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=-3, .readsize=0, .data="", .err=posErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=-3, .readsize=1, .data="", .err=posErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=-2, .readsize=0, .data="", .err=posErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=-2, .readsize=1, .data="", .err=posErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=-1, .readsize=0, .data="", .err=noErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=-1, .readsize=1, .data="a", .err=noErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=-1, .readsize=2, .data="a", .err=eofErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=0, .readsize=1, .data="", .err=eofErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=1, .readsize=0, .data="", .err=eofErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=-3, .readsize=0, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=-3, .readsize=1, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=-2, .readsize=0, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=-2, .readsize=1, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=-1, .readsize=0, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=-1, .readsize=1, .data="", .err=posErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=0, .readsize=1, .data="a", .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=0, .readsize=2, .data="ab", .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=0, .readsize=3, .data="ab", .err=eofErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=1, .readsize=0, .data="", .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=1, .readsize=1, .data="b", .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=1, .readsize=2, .data="b", .err=eofErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=2, .readsize=0, .data="", .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=2, .readsize=1, .data="", .err=eofErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=3, .readsize=0, .data="", .err=eofErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=-3, .readsize=0, .data="", .err=posErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=-3, .readsize=1, .data="", .err=posErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=-2, .readsize=0, .data="", .err=posErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=-2, .readsize=1, .data="", .err=posErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=-1, .readsize=0, .data="", .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=-1, .readsize=1, .data="a", .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=-1, .readsize=2, .data="ab", .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=-1, .readsize=3, .data="ab", .err=eofErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=0, .readsize=1, .data="b", .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=0, .readsize=2, .data="b", .err=eofErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=1, .readsize=0, .data="", .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=1, .readsize=1, .data="", .err=eofErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=2, .readsize=0, .data="", .err=eofErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-3, .readsize=0, .data="", .err=posErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-3, .readsize=1, .data="", .err=posErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-2, .readsize=0, .data="", .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-2, .readsize=1, .data="a", .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-2, .readsize=2, .data="ab", .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-2, .readsize=3, .data="ab", .err=eofErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-1, .readsize=0, .data="", .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-1, .readsize=1, .data="b", .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-1, .readsize=2, .data="b", .err=eofErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=0, .readsize=1, .data="", .err=eofErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=1, .readsize=0, .data="", .err=eofErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=-3, .readsize=0, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=-3, .readsize=1, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=-2, .readsize=0, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=-2, .readsize=1, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=-1, .readsize=0, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=-1, .readsize=1, .data="", .err=posErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=0, .readsize=1, .data="a", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=0, .readsize=2, .data="ab", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=0, .readsize=3, .data="abc", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=0, .readsize=4, .data="abc", .err=eofErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=1, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=1, .readsize=1, .data="b", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=1, .readsize=2, .data="bc", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=1, .readsize=3, .data="bc", .err=eofErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=2, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=2, .readsize=1, .data="c", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=2, .readsize=2, .data="c", .err=eofErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=3, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=3, .readsize=1, .data="", .err=eofErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=4, .readsize=0, .data="", .err=eofErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=-3, .readsize=0, .data="", .err=posErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=-3, .readsize=1, .data="", .err=posErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=-2, .readsize=0, .data="", .err=posErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=-2, .readsize=1, .data="", .err=posErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=-1, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=-1, .readsize=1, .data="a", .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=-1, .readsize=2, .data="ab", .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=-1, .readsize=3, .data="abc", .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=-1, .readsize=4, .data="abc", .err=eofErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=0, .readsize=1, .data="b", .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=0, .readsize=2, .data="bc", .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=0, .readsize=3, .data="bc", .err=eofErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=1, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=1, .readsize=1, .data="c", .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=1, .readsize=2, .data="c", .err=eofErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=2, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=2, .readsize=1, .data="", .err=eofErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=3, .readsize=0, .data="", .err=eofErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-3, .readsize=0, .data="", .err=posErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-3, .readsize=1, .data="", .err=posErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-2, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-2, .readsize=1, .data="a", .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-2, .readsize=2, .data="ab", .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-2, .readsize=3, .data="abc", .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-2, .readsize=4, .data="abc", .err=eofErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-1, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-1, .readsize=1, .data="b", .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-1, .readsize=2, .data="bc", .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-1, .readsize=3, .data="bc", .err=eofErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=0, .readsize=1, .data="c", .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=0, .readsize=2, .data="c", .err=eofErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=1, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=1, .readsize=1, .data="", .err=eofErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=2, .readsize=0, .data="", .err=eofErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-3, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-3, .readsize=1, .data="a", .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-3, .readsize=2, .data="ab", .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-3, .readsize=3, .data="abc", .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-3, .readsize=4, .data="abc", .err=eofErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-2, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-2, .readsize=1, .data="b", .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-2, .readsize=2, .data="bc", .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-2, .readsize=3, .data="bc", .err=eofErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-1, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-1, .readsize=1, .data="c", .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-1, .readsize=2, .data="c", .err=eofErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=0, .readsize=1, .data="", .err=eofErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=1, .readsize=0, .data="", .err=eofErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=-3, .readsize=0, .data="", .err=posErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=-3, .readsize=1, .data="", .err=posErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=-2, .readsize=0, .data="", .err=posErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=-2, .readsize=1, .data="", .err=posErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=-1, .readsize=0, .data="", .err=posErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=-1, .readsize=1, .data="", .err=posErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=0, .readsize=1, .data="a", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=0, .readsize=2, .data="ab", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=0, .readsize=3, .data="abc", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=0, .readsize=4, .data="abcd", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=0, .readsize=5, .data="abcd", .err=eofErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=1, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=1, .readsize=1, .data="b", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=1, .readsize=2, .data="bc", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=1, .readsize=3, .data="bcd", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=1, .readsize=4, .data="bcd", .err=eofErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=2, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=2, .readsize=1, .data="c", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=2, .readsize=2, .data="cd", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=2, .readsize=3, .data="cd", .err=eofErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=3, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=3, .readsize=1, .data="d", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=3, .readsize=2, .data="d", .err=eofErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=4, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=4, .readsize=1, .data="", .err=eofErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=5, .readsize=0, .data="", .err=eofErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=-3, .readsize=0, .data="", .err=posErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=-3, .readsize=1, .data="", .err=posErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=-2, .readsize=0, .data="", .err=posErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=-2, .readsize=1, .data="", .err=posErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=-1, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=-1, .readsize=1, .data="a", .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=-1, .readsize=2, .data="ab", .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=-1, .readsize=3, .data="abc", .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=-1, .readsize=4, .data="abcd", .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=-1, .readsize=5, .data="abcd", .err=eofErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=0, .readsize=1, .data="b", .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=0, .readsize=2, .data="bc", .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=0, .readsize=3, .data="bcd", .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=0, .readsize=4, .data="bcd", .err=eofErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=1, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=1, .readsize=1, .data="c", .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=1, .readsize=2, .data="cd", .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=1, .readsize=3, .data="cd", .err=eofErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=2, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=2, .readsize=1, .data="d", .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=2, .readsize=2, .data="d", .err=eofErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=3, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=3, .readsize=1, .data="", .err=eofErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=4, .readsize=0, .data="", .err=eofErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-3, .readsize=0, .data="", .err=posErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-3, .readsize=1, .data="", .err=posErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-2, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-2, .readsize=1, .data="a", .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-2, .readsize=2, .data="ab", .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-2, .readsize=3, .data="abc", .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-2, .readsize=4, .data="abcd", .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-2, .readsize=5, .data="abcd", .err=eofErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-1, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-1, .readsize=1, .data="b", .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-1, .readsize=2, .data="bc", .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-1, .readsize=3, .data="bcd", .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-1, .readsize=4, .data="bcd", .err=eofErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=0, .readsize=1, .data="c", .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=0, .readsize=2, .data="cd", .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=0, .readsize=3, .data="cd", .err=eofErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=1, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=1, .readsize=1, .data="d", .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=1, .readsize=2, .data="d", .err=eofErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=2, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=2, .readsize=1, .data="", .err=eofErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=3, .readsize=0, .data="", .err=eofErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-4, .readsize=0, .data="", .err=posErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-4, .readsize=1, .data="", .err=posErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-3, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-3, .readsize=1, .data="a", .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-3, .readsize=2, .data="ab", .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-3, .readsize=3, .data="abc", .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-3, .readsize=4, .data="abcd", .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-3, .readsize=5, .data="abcd", .err=eofErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-2, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-2, .readsize=1, .data="b", .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-2, .readsize=2, .data="bc", .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-2, .readsize=3, .data="bcd", .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-2, .readsize=4, .data="bcd", .err=eofErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-1, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-1, .readsize=1, .data="c", .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-1, .readsize=2, .data="cd", .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-1, .readsize=3, .data="cd", .err=eofErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=0, .readsize=1, .data="d", .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=0, .readsize=2, .data="d", .err=eofErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=1, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=1, .readsize=1, .data="", .err=eofErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=2, .readsize=0, .data="", .err=eofErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-5, .readsize=0, .data="", .err=posErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-5, .readsize=1, .data="", .err=posErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-4, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-4, .readsize=1, .data="a", .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-4, .readsize=2, .data="ab", .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-4, .readsize=3, .data="abc", .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-4, .readsize=4, .data="abcd", .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-4, .readsize=5, .data="abcd", .err=eofErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-3, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-3, .readsize=1, .data="b", .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-3, .readsize=2, .data="bc", .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-3, .readsize=3, .data="bcd", .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-3, .readsize=4, .data="bcd", .err=eofErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-2, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-2, .readsize=1, .data="c", .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-2, .readsize=2, .data="cd", .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-2, .readsize=3, .data="cd", .err=eofErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-1, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-1, .readsize=1, .data="d", .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-1, .readsize=2, .data="d", .err=eofErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=0, .readsize=0, .data="", .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=0, .readsize=1, .data="", .err=eofErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=1, .readsize=0, .data="", .err=eofErr},
		{-1}
	};

	for (struct line *l=lines; l->filesize!=-1; l++) {
		short ref = mkfile(l->filesize);

		// Pre-set the mark
		struct IOParam setuppb = {.ioRefNum=ref, .ioPosMode=fsFromStart, .ioPosOffset=l->initialpos};
		PBSetFPosSync((void *)&setuppb);
		long thepos = 99;
		GetFPos(ref, &thepos);
		if (thepos != l->initialpos) bailout("Could not pre-set mark, wanted %d got %d", l->initialpos, thepos);

		char buf[6] = {};

		struct IOParam pb = {.ioRefNum=ref, .ioPosMode=l->mode, .ioPosOffset=l->delta, .ioReqCount=l->readsize, .ioActCount=99, .ioBuffer=buf};
		PBReadSync((void *)&pb);

		bool ok = !strcmp(buf, l->data) && pb.ioResult==l->err;
		result(ok, "Read(filesize=%d, initialpos=%d, mode=%s, delta=%d, readsize=%d) -> (data=\"%s\", err=%s)",
			l->filesize, l->initialpos, modename(l->mode), l->delta, l->readsize, l->data, errname(l->err));

		if (!ok) {
			printf("# got (data=\"%s\", err=%s)\n", buf, errname(pb.ioResult));
		}

		// HFS has been observed to return a negative ioActCount
		if (pb.ioActCount != strlen(buf) && pb.ioActCount >= 0) {
			bailout("PB.ioActCount contradicts the letters in the buffer (%d vs %d)\n", pb.ioActCount, strlen(buf));
		}

		thepos = 99;
		GetFPos(ref, &thepos);
		if (thepos != pb.ioPosOffset) bailout("FCB.fcbCrPs != PB.ioPosOffset");

		FSClose(ref);
		FSDelete("\pscratch", 0);
	}
}


void testWrite(void) {
	puts("# Testing Write");

	struct line {
		int filesize, initialpos, mode, delta, writesize, finalpos, err;
		char data[12];
	};

	struct line lines[] = {
		{.filesize=0, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=0, .data="", .finalpos=0, .err=noErr},
		{.filesize=0, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=1, .data="A", .finalpos=1, .err=noErr},
		{.filesize=0, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=2, .data="AB", .finalpos=2, .err=noErr},
		{.filesize=0, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=3, .data="ABC", .finalpos=3, .err=noErr},
		{.filesize=0, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=0, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=0, .data="a", .finalpos=0, .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=1, .data="A", .finalpos=1, .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=2, .data="AB", .finalpos=2, .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=3, .data="ABC", .finalpos=3, .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=1, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=0, .data="a", .finalpos=1, .err=noErr},
		{.filesize=1, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=1, .data="aA", .finalpos=2, .err=noErr},
		{.filesize=1, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=2, .data="aAB", .finalpos=3, .err=noErr},
		{.filesize=1, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=3, .data="aABC", .finalpos=4, .err=noErr},
		{.filesize=1, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=4, .data="aABCD", .finalpos=5, .err=noErr},
		{.filesize=1, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=5, .data="aABCDE", .finalpos=6, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=0, .data="ab", .finalpos=0, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=1, .data="Ab", .finalpos=1, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=2, .data="AB", .finalpos=2, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=3, .data="ABC", .finalpos=3, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=0, .data="ab", .finalpos=1, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=1, .data="aA", .finalpos=2, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=2, .data="aAB", .finalpos=3, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=3, .data="aABC", .finalpos=4, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=4, .data="aABCD", .finalpos=5, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=5, .data="aABCDE", .finalpos=6, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsAtMark, .delta=3, .writesize=0, .data="ab", .finalpos=2, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsAtMark, .delta=3, .writesize=1, .data="abA", .finalpos=3, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsAtMark, .delta=3, .writesize=2, .data="abAB", .finalpos=4, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsAtMark, .delta=3, .writesize=3, .data="abABC", .finalpos=5, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsAtMark, .delta=3, .writesize=4, .data="abABCD", .finalpos=6, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsAtMark, .delta=3, .writesize=5, .data="abABCDE", .finalpos=7, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=0, .data="abc", .finalpos=0, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=1, .data="Abc", .finalpos=1, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=2, .data="ABc", .finalpos=2, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=3, .data="ABC", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=0, .data="abc", .finalpos=1, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=1, .data="aAc", .finalpos=2, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=2, .data="aAB", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=3, .data="aABC", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=4, .data="aABCD", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=5, .data="aABCDE", .finalpos=6, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsAtMark, .delta=3, .writesize=0, .data="abc", .finalpos=2, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsAtMark, .delta=3, .writesize=1, .data="abA", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsAtMark, .delta=3, .writesize=2, .data="abAB", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsAtMark, .delta=3, .writesize=3, .data="abABC", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsAtMark, .delta=3, .writesize=4, .data="abABCD", .finalpos=6, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsAtMark, .delta=3, .writesize=5, .data="abABCDE", .finalpos=7, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsAtMark, .delta=3, .writesize=0, .data="abc", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsAtMark, .delta=3, .writesize=1, .data="abcA", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsAtMark, .delta=3, .writesize=2, .data="abcAB", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsAtMark, .delta=3, .writesize=3, .data="abcABC", .finalpos=6, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsAtMark, .delta=3, .writesize=4, .data="abcABCD", .finalpos=7, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsAtMark, .delta=3, .writesize=5, .data="abcABCDE", .finalpos=8, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=0, .data="abcd", .finalpos=0, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=1, .data="Abcd", .finalpos=1, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=2, .data="ABcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=3, .data="ABCd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsAtMark, .delta=3, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=0, .data="abcd", .finalpos=1, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=1, .data="aAcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=2, .data="aABd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=3, .data="aABC", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=4, .data="aABCD", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsAtMark, .delta=3, .writesize=5, .data="aABCDE", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsAtMark, .delta=3, .writesize=0, .data="abcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsAtMark, .delta=3, .writesize=1, .data="abAd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsAtMark, .delta=3, .writesize=2, .data="abAB", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsAtMark, .delta=3, .writesize=3, .data="abABC", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsAtMark, .delta=3, .writesize=4, .data="abABCD", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsAtMark, .delta=3, .writesize=5, .data="abABCDE", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsAtMark, .delta=3, .writesize=0, .data="abcd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsAtMark, .delta=3, .writesize=1, .data="abcA", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsAtMark, .delta=3, .writesize=2, .data="abcAB", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsAtMark, .delta=3, .writesize=3, .data="abcABC", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsAtMark, .delta=3, .writesize=4, .data="abcABCD", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsAtMark, .delta=3, .writesize=5, .data="abcABCDE", .finalpos=8, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsAtMark, .delta=3, .writesize=0, .data="abcd", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsAtMark, .delta=3, .writesize=1, .data="abcdA", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsAtMark, .delta=3, .writesize=2, .data="abcdAB", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsAtMark, .delta=3, .writesize=3, .data="abcdABC", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsAtMark, .delta=3, .writesize=4, .data="abcdABCD", .finalpos=8, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsAtMark, .delta=3, .writesize=5, .data="abcdABCDE", .finalpos=9, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=0, .writesize=0, .data="abc", .finalpos=0, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=0, .writesize=1, .data="Abc", .finalpos=1, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=0, .writesize=2, .data="ABc", .finalpos=2, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=0, .writesize=3, .data="ABC", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=0, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=0, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=1, .writesize=0, .data="abc", .finalpos=1, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=1, .writesize=1, .data="aAc", .finalpos=2, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=1, .writesize=2, .data="aAB", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=1, .writesize=3, .data="aABC", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=1, .writesize=4, .data="aABCD", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=1, .writesize=5, .data="aABCDE", .finalpos=6, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=2, .writesize=0, .data="abc", .finalpos=2, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=2, .writesize=1, .data="abA", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=2, .writesize=2, .data="abAB", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=2, .writesize=3, .data="abABC", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=2, .writesize=4, .data="abABCD", .finalpos=6, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=2, .writesize=5, .data="abABCDE", .finalpos=7, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=3, .writesize=0, .data="abc", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=3, .writesize=1, .data="abcA", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=3, .writesize=2, .data="abcAB", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=3, .writesize=3, .data="abcABC", .finalpos=6, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=3, .writesize=4, .data="abcABCD", .finalpos=7, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromStart, .delta=3, .writesize=5, .data="abcABCDE", .finalpos=8, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=0, .writesize=0, .data="abcd", .finalpos=0, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=0, .writesize=1, .data="Abcd", .finalpos=1, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=0, .writesize=2, .data="ABcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=0, .writesize=3, .data="ABCd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=0, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=0, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=1, .writesize=0, .data="abcd", .finalpos=1, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=1, .writesize=1, .data="aAcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=1, .writesize=2, .data="aABd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=1, .writesize=3, .data="aABC", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=1, .writesize=4, .data="aABCD", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=1, .writesize=5, .data="aABCDE", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=2, .writesize=0, .data="abcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=2, .writesize=1, .data="abAd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=2, .writesize=2, .data="abAB", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=2, .writesize=3, .data="abABC", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=2, .writesize=4, .data="abABCD", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=2, .writesize=5, .data="abABCDE", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=3, .writesize=0, .data="abcd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=3, .writesize=1, .data="abcA", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=3, .writesize=2, .data="abcAB", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=3, .writesize=3, .data="abcABC", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=3, .writesize=4, .data="abcABCD", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=3, .writesize=5, .data="abcABCDE", .finalpos=8, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=4, .writesize=0, .data="abcd", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=4, .writesize=1, .data="abcdA", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=4, .writesize=2, .data="abcdAB", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=4, .writesize=3, .data="abcdABC", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=4, .writesize=4, .data="abcdABCD", .finalpos=8, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromStart, .delta=4, .writesize=5, .data="abcdABCDE", .finalpos=9, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=-3, .writesize=0, .data="abc", .finalpos=0, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=-3, .writesize=1, .data="Abc", .finalpos=1, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=-3, .writesize=2, .data="ABc", .finalpos=2, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=-3, .writesize=3, .data="ABC", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=-3, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=-3, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=-2, .writesize=0, .data="abc", .finalpos=1, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=-2, .writesize=1, .data="aAc", .finalpos=2, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=-2, .writesize=2, .data="aAB", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=-2, .writesize=3, .data="aABC", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=-2, .writesize=4, .data="aABCD", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=-2, .writesize=5, .data="aABCDE", .finalpos=6, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=-1, .writesize=0, .data="abc", .finalpos=2, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=-1, .writesize=1, .data="abA", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=-1, .writesize=2, .data="abAB", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=-1, .writesize=3, .data="abABC", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=-1, .writesize=4, .data="abABCD", .finalpos=6, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=-1, .writesize=5, .data="abABCDE", .finalpos=7, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=0, .writesize=0, .data="abc", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=0, .writesize=1, .data="abcA", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=0, .writesize=2, .data="abcAB", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=0, .writesize=3, .data="abcABC", .finalpos=6, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=0, .writesize=4, .data="abcABCD", .finalpos=7, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromLEOF, .delta=0, .writesize=5, .data="abcABCDE", .finalpos=8, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-4, .writesize=0, .data="abcd", .finalpos=0, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-4, .writesize=1, .data="Abcd", .finalpos=1, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-4, .writesize=2, .data="ABcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-4, .writesize=3, .data="ABCd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-4, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-4, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-3, .writesize=0, .data="abcd", .finalpos=1, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-3, .writesize=1, .data="aAcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-3, .writesize=2, .data="aABd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-3, .writesize=3, .data="aABC", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-3, .writesize=4, .data="aABCD", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-3, .writesize=5, .data="aABCDE", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-2, .writesize=0, .data="abcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-2, .writesize=1, .data="abAd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-2, .writesize=2, .data="abAB", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-2, .writesize=3, .data="abABC", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-2, .writesize=4, .data="abABCD", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-2, .writesize=5, .data="abABCDE", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-1, .writesize=0, .data="abcd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-1, .writesize=1, .data="abcA", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-1, .writesize=2, .data="abcAB", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-1, .writesize=3, .data="abcABC", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-1, .writesize=4, .data="abcABCD", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=-1, .writesize=5, .data="abcABCDE", .finalpos=8, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=0, .writesize=0, .data="abcd", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=0, .writesize=1, .data="abcdA", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=0, .writesize=2, .data="abcdAB", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=0, .writesize=3, .data="abcdABC", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=0, .writesize=4, .data="abcdABCD", .finalpos=8, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromLEOF, .delta=0, .writesize=5, .data="abcdABCDE", .finalpos=9, .err=noErr},
		{.filesize=0, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=0, .data="", .finalpos=0, .err=noErr},
		{.filesize=0, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=1, .data="A", .finalpos=1, .err=noErr},
		{.filesize=0, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=2, .data="AB", .finalpos=2, .err=noErr},
		{.filesize=0, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=3, .data="ABC", .finalpos=3, .err=noErr},
		{.filesize=0, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=0, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=0, .data="a", .finalpos=0, .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=1, .data="A", .finalpos=1, .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=2, .data="AB", .finalpos=2, .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=3, .data="ABC", .finalpos=3, .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=0, .data="a", .finalpos=1, .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=1, .data="aA", .finalpos=2, .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=2, .data="aAB", .finalpos=3, .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=3, .data="aABC", .finalpos=4, .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=4, .data="aABCD", .finalpos=5, .err=noErr},
		{.filesize=1, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=5, .data="aABCDE", .finalpos=6, .err=noErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=0, .data="a", .finalpos=0, .err=noErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=1, .data="A", .finalpos=1, .err=noErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=2, .data="AB", .finalpos=2, .err=noErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=3, .data="ABC", .finalpos=3, .err=noErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=0, .data="a", .finalpos=1, .err=noErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=1, .data="aA", .finalpos=2, .err=noErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=2, .data="aAB", .finalpos=3, .err=noErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=3, .data="aABC", .finalpos=4, .err=noErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=4, .data="aABCD", .finalpos=5, .err=noErr},
		{.filesize=1, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=5, .data="aABCDE", .finalpos=6, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=0, .data="ab", .finalpos=0, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=1, .data="Ab", .finalpos=1, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=2, .data="AB", .finalpos=2, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=3, .data="ABC", .finalpos=3, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=0, .data="ab", .finalpos=1, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=1, .data="aA", .finalpos=2, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=2, .data="aAB", .finalpos=3, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=3, .data="aABC", .finalpos=4, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=4, .data="aABCD", .finalpos=5, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=5, .data="aABCDE", .finalpos=6, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=2, .writesize=0, .data="ab", .finalpos=2, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=2, .writesize=1, .data="abA", .finalpos=3, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=2, .writesize=2, .data="abAB", .finalpos=4, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=2, .writesize=3, .data="abABC", .finalpos=5, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=2, .writesize=4, .data="abABCD", .finalpos=6, .err=noErr},
		{.filesize=2, .initialpos=0, .mode=fsFromMark, .delta=2, .writesize=5, .data="abABCDE", .finalpos=7, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=0, .data="ab", .finalpos=0, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=1, .data="Ab", .finalpos=1, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=2, .data="AB", .finalpos=2, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=3, .data="ABC", .finalpos=3, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=0, .data="ab", .finalpos=1, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=1, .data="aA", .finalpos=2, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=2, .data="aAB", .finalpos=3, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=3, .data="aABC", .finalpos=4, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=4, .data="aABCD", .finalpos=5, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=5, .data="aABCDE", .finalpos=6, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=1, .writesize=0, .data="ab", .finalpos=2, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=1, .writesize=1, .data="abA", .finalpos=3, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=1, .writesize=2, .data="abAB", .finalpos=4, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=1, .writesize=3, .data="abABC", .finalpos=5, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=1, .writesize=4, .data="abABCD", .finalpos=6, .err=noErr},
		{.filesize=2, .initialpos=1, .mode=fsFromMark, .delta=1, .writesize=5, .data="abABCDE", .finalpos=7, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-2, .writesize=0, .data="ab", .finalpos=0, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-2, .writesize=1, .data="Ab", .finalpos=1, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-2, .writesize=2, .data="AB", .finalpos=2, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-2, .writesize=3, .data="ABC", .finalpos=3, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-2, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-2, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-1, .writesize=0, .data="ab", .finalpos=1, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-1, .writesize=1, .data="aA", .finalpos=2, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-1, .writesize=2, .data="aAB", .finalpos=3, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-1, .writesize=3, .data="aABC", .finalpos=4, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-1, .writesize=4, .data="aABCD", .finalpos=5, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=-1, .writesize=5, .data="aABCDE", .finalpos=6, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=0, .writesize=0, .data="ab", .finalpos=2, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=0, .writesize=1, .data="abA", .finalpos=3, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=0, .writesize=2, .data="abAB", .finalpos=4, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=0, .writesize=3, .data="abABC", .finalpos=5, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=0, .writesize=4, .data="abABCD", .finalpos=6, .err=noErr},
		{.filesize=2, .initialpos=2, .mode=fsFromMark, .delta=0, .writesize=5, .data="abABCDE", .finalpos=7, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=0, .data="abc", .finalpos=0, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=1, .data="Abc", .finalpos=1, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=2, .data="ABc", .finalpos=2, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=3, .data="ABC", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=0, .data="abc", .finalpos=1, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=1, .data="aAc", .finalpos=2, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=2, .data="aAB", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=3, .data="aABC", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=4, .data="aABCD", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=5, .data="aABCDE", .finalpos=6, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=2, .writesize=0, .data="abc", .finalpos=2, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=2, .writesize=1, .data="abA", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=2, .writesize=2, .data="abAB", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=2, .writesize=3, .data="abABC", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=2, .writesize=4, .data="abABCD", .finalpos=6, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=2, .writesize=5, .data="abABCDE", .finalpos=7, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=3, .writesize=0, .data="abc", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=3, .writesize=1, .data="abcA", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=3, .writesize=2, .data="abcAB", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=3, .writesize=3, .data="abcABC", .finalpos=6, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=3, .writesize=4, .data="abcABCD", .finalpos=7, .err=noErr},
		{.filesize=3, .initialpos=0, .mode=fsFromMark, .delta=3, .writesize=5, .data="abcABCDE", .finalpos=8, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=0, .data="abc", .finalpos=0, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=1, .data="Abc", .finalpos=1, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=2, .data="ABc", .finalpos=2, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=3, .data="ABC", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=0, .data="abc", .finalpos=1, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=1, .data="aAc", .finalpos=2, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=2, .data="aAB", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=3, .data="aABC", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=4, .data="aABCD", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=5, .data="aABCDE", .finalpos=6, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=1, .writesize=0, .data="abc", .finalpos=2, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=1, .writesize=1, .data="abA", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=1, .writesize=2, .data="abAB", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=1, .writesize=3, .data="abABC", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=1, .writesize=4, .data="abABCD", .finalpos=6, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=1, .writesize=5, .data="abABCDE", .finalpos=7, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=2, .writesize=0, .data="abc", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=2, .writesize=1, .data="abcA", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=2, .writesize=2, .data="abcAB", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=2, .writesize=3, .data="abcABC", .finalpos=6, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=2, .writesize=4, .data="abcABCD", .finalpos=7, .err=noErr},
		{.filesize=3, .initialpos=1, .mode=fsFromMark, .delta=2, .writesize=5, .data="abcABCDE", .finalpos=8, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-2, .writesize=0, .data="abc", .finalpos=0, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-2, .writesize=1, .data="Abc", .finalpos=1, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-2, .writesize=2, .data="ABc", .finalpos=2, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-2, .writesize=3, .data="ABC", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-2, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-2, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-1, .writesize=0, .data="abc", .finalpos=1, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-1, .writesize=1, .data="aAc", .finalpos=2, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-1, .writesize=2, .data="aAB", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-1, .writesize=3, .data="aABC", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-1, .writesize=4, .data="aABCD", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=-1, .writesize=5, .data="aABCDE", .finalpos=6, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=0, .writesize=0, .data="abc", .finalpos=2, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=0, .writesize=1, .data="abA", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=0, .writesize=2, .data="abAB", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=0, .writesize=3, .data="abABC", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=0, .writesize=4, .data="abABCD", .finalpos=6, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=0, .writesize=5, .data="abABCDE", .finalpos=7, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=1, .writesize=0, .data="abc", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=1, .writesize=1, .data="abcA", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=1, .writesize=2, .data="abcAB", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=1, .writesize=3, .data="abcABC", .finalpos=6, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=1, .writesize=4, .data="abcABCD", .finalpos=7, .err=noErr},
		{.filesize=3, .initialpos=2, .mode=fsFromMark, .delta=1, .writesize=5, .data="abcABCDE", .finalpos=8, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-3, .writesize=0, .data="abc", .finalpos=0, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-3, .writesize=1, .data="Abc", .finalpos=1, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-3, .writesize=2, .data="ABc", .finalpos=2, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-3, .writesize=3, .data="ABC", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-3, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-3, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-2, .writesize=0, .data="abc", .finalpos=1, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-2, .writesize=1, .data="aAc", .finalpos=2, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-2, .writesize=2, .data="aAB", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-2, .writesize=3, .data="aABC", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-2, .writesize=4, .data="aABCD", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-2, .writesize=5, .data="aABCDE", .finalpos=6, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-1, .writesize=0, .data="abc", .finalpos=2, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-1, .writesize=1, .data="abA", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-1, .writesize=2, .data="abAB", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-1, .writesize=3, .data="abABC", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-1, .writesize=4, .data="abABCD", .finalpos=6, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=-1, .writesize=5, .data="abABCDE", .finalpos=7, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=0, .writesize=0, .data="abc", .finalpos=3, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=0, .writesize=1, .data="abcA", .finalpos=4, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=0, .writesize=2, .data="abcAB", .finalpos=5, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=0, .writesize=3, .data="abcABC", .finalpos=6, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=0, .writesize=4, .data="abcABCD", .finalpos=7, .err=noErr},
		{.filesize=3, .initialpos=3, .mode=fsFromMark, .delta=0, .writesize=5, .data="abcABCDE", .finalpos=8, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=0, .data="abcd", .finalpos=0, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=1, .data="Abcd", .finalpos=1, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=2, .data="ABcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=3, .data="ABCd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=0, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=0, .data="abcd", .finalpos=1, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=1, .data="aAcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=2, .data="aABd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=3, .data="aABC", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=4, .data="aABCD", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=1, .writesize=5, .data="aABCDE", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=2, .writesize=0, .data="abcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=2, .writesize=1, .data="abAd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=2, .writesize=2, .data="abAB", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=2, .writesize=3, .data="abABC", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=2, .writesize=4, .data="abABCD", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=2, .writesize=5, .data="abABCDE", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=3, .writesize=0, .data="abcd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=3, .writesize=1, .data="abcA", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=3, .writesize=2, .data="abcAB", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=3, .writesize=3, .data="abcABC", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=3, .writesize=4, .data="abcABCD", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=3, .writesize=5, .data="abcABCDE", .finalpos=8, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=4, .writesize=0, .data="abcd", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=4, .writesize=1, .data="abcdA", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=4, .writesize=2, .data="abcdAB", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=4, .writesize=3, .data="abcdABC", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=4, .writesize=4, .data="abcdABCD", .finalpos=8, .err=noErr},
		{.filesize=4, .initialpos=0, .mode=fsFromMark, .delta=4, .writesize=5, .data="abcdABCDE", .finalpos=9, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=0, .data="abcd", .finalpos=0, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=1, .data="Abcd", .finalpos=1, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=2, .data="ABcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=3, .data="ABCd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=-1, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=0, .data="abcd", .finalpos=1, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=1, .data="aAcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=2, .data="aABd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=3, .data="aABC", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=4, .data="aABCD", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=0, .writesize=5, .data="aABCDE", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=1, .writesize=0, .data="abcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=1, .writesize=1, .data="abAd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=1, .writesize=2, .data="abAB", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=1, .writesize=3, .data="abABC", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=1, .writesize=4, .data="abABCD", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=1, .writesize=5, .data="abABCDE", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=2, .writesize=0, .data="abcd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=2, .writesize=1, .data="abcA", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=2, .writesize=2, .data="abcAB", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=2, .writesize=3, .data="abcABC", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=2, .writesize=4, .data="abcABCD", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=2, .writesize=5, .data="abcABCDE", .finalpos=8, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=3, .writesize=0, .data="abcd", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=3, .writesize=1, .data="abcdA", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=3, .writesize=2, .data="abcdAB", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=3, .writesize=3, .data="abcdABC", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=3, .writesize=4, .data="abcdABCD", .finalpos=8, .err=noErr},
		{.filesize=4, .initialpos=1, .mode=fsFromMark, .delta=3, .writesize=5, .data="abcdABCDE", .finalpos=9, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-2, .writesize=0, .data="abcd", .finalpos=0, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-2, .writesize=1, .data="Abcd", .finalpos=1, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-2, .writesize=2, .data="ABcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-2, .writesize=3, .data="ABCd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-2, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-2, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-1, .writesize=0, .data="abcd", .finalpos=1, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-1, .writesize=1, .data="aAcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-1, .writesize=2, .data="aABd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-1, .writesize=3, .data="aABC", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-1, .writesize=4, .data="aABCD", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=-1, .writesize=5, .data="aABCDE", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=0, .writesize=0, .data="abcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=0, .writesize=1, .data="abAd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=0, .writesize=2, .data="abAB", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=0, .writesize=3, .data="abABC", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=0, .writesize=4, .data="abABCD", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=0, .writesize=5, .data="abABCDE", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=1, .writesize=0, .data="abcd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=1, .writesize=1, .data="abcA", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=1, .writesize=2, .data="abcAB", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=1, .writesize=3, .data="abcABC", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=1, .writesize=4, .data="abcABCD", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=1, .writesize=5, .data="abcABCDE", .finalpos=8, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=2, .writesize=0, .data="abcd", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=2, .writesize=1, .data="abcdA", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=2, .writesize=2, .data="abcdAB", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=2, .writesize=3, .data="abcdABC", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=2, .writesize=4, .data="abcdABCD", .finalpos=8, .err=noErr},
		{.filesize=4, .initialpos=2, .mode=fsFromMark, .delta=2, .writesize=5, .data="abcdABCDE", .finalpos=9, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-3, .writesize=0, .data="abcd", .finalpos=0, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-3, .writesize=1, .data="Abcd", .finalpos=1, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-3, .writesize=2, .data="ABcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-3, .writesize=3, .data="ABCd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-3, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-3, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-2, .writesize=0, .data="abcd", .finalpos=1, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-2, .writesize=1, .data="aAcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-2, .writesize=2, .data="aABd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-2, .writesize=3, .data="aABC", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-2, .writesize=4, .data="aABCD", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-2, .writesize=5, .data="aABCDE", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-1, .writesize=0, .data="abcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-1, .writesize=1, .data="abAd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-1, .writesize=2, .data="abAB", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-1, .writesize=3, .data="abABC", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-1, .writesize=4, .data="abABCD", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=-1, .writesize=5, .data="abABCDE", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=0, .writesize=0, .data="abcd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=0, .writesize=1, .data="abcA", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=0, .writesize=2, .data="abcAB", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=0, .writesize=3, .data="abcABC", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=0, .writesize=4, .data="abcABCD", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=0, .writesize=5, .data="abcABCDE", .finalpos=8, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=1, .writesize=0, .data="abcd", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=1, .writesize=1, .data="abcdA", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=1, .writesize=2, .data="abcdAB", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=1, .writesize=3, .data="abcdABC", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=1, .writesize=4, .data="abcdABCD", .finalpos=8, .err=noErr},
		{.filesize=4, .initialpos=3, .mode=fsFromMark, .delta=1, .writesize=5, .data="abcdABCDE", .finalpos=9, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-4, .writesize=0, .data="abcd", .finalpos=0, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-4, .writesize=1, .data="Abcd", .finalpos=1, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-4, .writesize=2, .data="ABcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-4, .writesize=3, .data="ABCd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-4, .writesize=4, .data="ABCD", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-4, .writesize=5, .data="ABCDE", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-3, .writesize=0, .data="abcd", .finalpos=1, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-3, .writesize=1, .data="aAcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-3, .writesize=2, .data="aABd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-3, .writesize=3, .data="aABC", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-3, .writesize=4, .data="aABCD", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-3, .writesize=5, .data="aABCDE", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-2, .writesize=0, .data="abcd", .finalpos=2, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-2, .writesize=1, .data="abAd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-2, .writesize=2, .data="abAB", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-2, .writesize=3, .data="abABC", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-2, .writesize=4, .data="abABCD", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-2, .writesize=5, .data="abABCDE", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-1, .writesize=0, .data="abcd", .finalpos=3, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-1, .writesize=1, .data="abcA", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-1, .writesize=2, .data="abcAB", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-1, .writesize=3, .data="abcABC", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-1, .writesize=4, .data="abcABCD", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=-1, .writesize=5, .data="abcABCDE", .finalpos=8, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=0, .writesize=0, .data="abcd", .finalpos=4, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=0, .writesize=1, .data="abcdA", .finalpos=5, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=0, .writesize=2, .data="abcdAB", .finalpos=6, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=0, .writesize=3, .data="abcdABC", .finalpos=7, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=0, .writesize=4, .data="abcdABCD", .finalpos=8, .err=noErr},
		{.filesize=4, .initialpos=4, .mode=fsFromMark, .delta=0, .writesize=5, .data="abcdABCDE", .finalpos=9, .err=noErr},
		{-1}
	};

	for (struct line *l=lines; l->filesize!=-1; l++) {
		short ref = mkfile(l->filesize);

		// Pre-set the mark
		struct IOParam setuppb = {.ioRefNum=ref, .ioPosMode=fsFromStart, .ioPosOffset=l->initialpos};
		PBSetFPosSync((void *)&setuppb);
		long thepos = 99;
		GetFPos(ref, &thepos);
		if (thepos != l->initialpos) bailout("Could not pre-set mark, wanted %d got %d", l->initialpos, thepos);

		struct IOParam pb = {.ioRefNum=ref, .ioPosMode=l->mode, .ioPosOffset=l->delta, .ioReqCount=l->writesize, .ioActCount=99, .ioBuffer="ABCDEFGHIJ"};
		PBWriteSync((void *)&pb);

		// Where did the mark end up?
		long finalpos = 99;
		GetFPos(ref, &finalpos);
		if (finalpos != pb.ioPosOffset) bailout("FCB.fcbCrPs != PB.ioPosOffset");

		// What is the entire-file content now?
		char buf[20] = {};
		memset(buf, 0, sizeof buf);
		struct IOParam backpb = {.ioRefNum=ref, .ioPosMode=fsFromStart, .ioPosOffset=0, .ioReqCount=sizeof buf, .ioBuffer=buf};
		PBReadSync((void *)&backpb);
		if (backpb.ioResult != noErr && backpb.ioResult != eofErr) bailout("Readback failure");

		bool ok = finalpos == l->finalpos &&
			strlen(l->data) == backpb.ioActCount &&
			!strcmp(l->data, buf) &&
			pb.ioResult == l->err;

		result(ok, "Write(filesize=%d, initialpos=%d, mode=%s, delta=%d, writesize=%d) -> (data=\"%s\", finalpos=%d, err=%s)",
			l->filesize, l->initialpos, modename(l->mode), l->delta, l->writesize, l->data, l->finalpos, errname(l->err));

		if (!ok) {
			printf("# got (data=\"%s\", finalpos=%d, err=%s)\n", buf, finalpos, errname(pb.ioResult));
		}

		FSClose(ref);
		FSDelete("\pscratch", 0);
	}
}

int main(void) {
	freopen("testresult.txt", "w", stdout);
	FSDelete("\pscratch", 0);

	testSetFPos();
	testRead();
	testWrite();

	printf("1..%d\n", counter);
	return 0;
}

bool result(bool ok, const char *fmt, ...) {
	printf((ok) ? "ok %d - " : "not ok %d - ", ++counter);
	va_list args;
	va_start(args, fmt);
	vprintf(fmt, args);
	va_end(args);
	putc('\n', stdout);
	return ok;
}

void bailout(const char *fmt, ...) {
	fputs("Bail out! ", stdout);
	va_list args;
	va_start(args, fmt);
	vprintf(fmt, args);
	va_end(args);
	putc('\n', stdout);
	exit(1);
}

short mkfile(int size) {
	struct FileParam cpb = {.ioNamePtr="\pscratch"};
	if (PBCreateSync((void *)&cpb)) bailout("Could not create scratch");;

	struct FileParam opb = {.ioNamePtr="\pscratch"};
	if (PBOpenSync((void *)&opb)) bailout("Could not open scratch");

	short ref = opb.ioFRefNum;

	struct IOParam wpb = {.ioRefNum=ref, .ioBuffer="abcdefghijklmnopqrstuvwxyz", .ioReqCount=size};
	if (PBWriteSync((void *)&wpb) || wpb.ioActCount != size) bailout("Coult not write scratch");

	return ref;
}

const char *modename(char mode) {
	switch (mode & 3) {
	case 0: return "fsAtMark";
	case 1: return "fsFromStart";
	case 2: return "fsFromLEOF";
	case 3: return "fsFromMark";
	}
}

static const char *errname(short err) {
	switch (err) {
		case 0: return "noErr";
		case -17: return "controlErr";
		case -18: return "statusErr";
		case -19: return "readErr";
		case -20: return "writErr";
		case -23: return "openErr";
		case -24: return "closErr";
		case -33: return "dirFulErr";
		case -34: return "dskFulErr";
		case -35: return "nsvErr";
		case -36: return "ioErr";
		case -37: return "bdNamErr";
		case -38: return "fnOpnErr";
		case -39: return "eofErr";
		case -40: return "posErr";
		case -42: return "tmfoErr";
		case -43: return "fnfErr";
		case -44: return "wPrErr";
		case -45: return "fLckdErr";
		case -46: return "vLckdErr";
		case -47: return "fBsyErr";
		case -48: return "dupFNErr";
		case -49: return "opWrErr";
		case -50: return "paramErr";
		case -51: return "rfNumErr";
		case -52: return "gfpErr";
		case -53: return "volOffLinErr";
		case -54: return "permErr";
		case -55: return "volOnLinErr";
		case -58: return "extFSErr";
		case -59: return "fsRnErr";
		case -60: return "badMDBErr";
		case -61: return "wrPermErr";
		case -65: return "offLinErr";
		case -120: return "dirNFErr";
		case -121: return "tmwdoErr";
		case -122: return "badMovErr";
		default: return "unknownErr";
	}
}

